<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CraneIQ Pro Configuration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        slate: {
                            850: '#1e293b',
                            900: '#0f172a',
                        },
                        blue: {
                            600: '#2563eb',
                            700: '#1d4ed8',
                        },
                        primary: '#2563EB',
                        primaryHover: '#1D4ED8',
                        secondary: '#475569',
                        success: '#10B981',
                        warning: '#F59E0B',
                        danger: '#EF4444',
                        surface: '#F8FAFC',
                        card: '#FFFFFF',
                        border: '#E2E8F0',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace']
                    }
                }
            }
        }
        window.FontAwesomeConfig = { autoReplaceSvg: 'nest' };
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #CBD5E1; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #94A3B8; }
        body { font-family: 'Inter', sans-serif; background-color: #F1F5F9; color: #1E293B; }
        .toggle-checkbox:checked { right: 0; border-color: #2563EB; }
        .toggle-checkbox:checked + .toggle-label { background-color: #2563EB; }
        .radio-checkbox:checked { background-color: #2563EB; border-color: #2563EB; }
        .glass-panel { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
        
        /* Sidebar Styles */
        .sidebar {
            width: 260px;
            background: white;
            border-right: 1px solid #E2E8F0;
            height: 100vh;
            overflow-y: auto;
            position: fixed;
            left: 0;
            top: 0;
            z-index: 40;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
        }
        
        .sidebar-logo {
            height: 64px;
            display: flex;
            align-items: center;
            padding: 0 20px;
            border-bottom: 1px solid #E2E8F0;
            background: white;
        }
        
        .logo-text {
            font-weight: 700;
            font-size: 18px;
            color: #2563EB;
        }
        
        .sidebar-nav {
            flex: 1;
            padding: 16px 0;
            overflow-y: auto;
        }
        
        .nav-section {
            margin-bottom: 24px;
        }
        
        .section-title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #64748B;
            padding: 0 20px 8px;
            margin-bottom: 4px;
            border-bottom: 1px solid #F1F5F9;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: 8px 20px;
            color: #475569;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            border-left: 3px solid transparent;
            cursor: pointer;
        }
        
        .nav-item:hover {
            background: #F8FAFC;
            color: #2563EB;
        }
        
        .nav-item.active {
            background: #EFF6FF;
            color: #2563EB;
            border-left-color: #2563EB;
            font-weight: 600;
        }
        
        .nav-item i {
            width: 20px;
            margin-right: 12px;
            font-size: 14px;
            text-align: center;
        }
        
        .nav-item-count {
            margin-left: auto;
            background: #E2E8F0;
            color: #475569;
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 10px;
            font-weight: 500;
        }
        
        .sidebar-footer {
            padding: 16px 20px;
            border-top: 1px solid #E2E8F0;
            background: white;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            background: #2563EB;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }
        
        .sidebar-toggle {
            display: none;
            position: fixed;
            left: 260px;
            top: 20px;
            z-index: 100;
            background: white;
            border: 1px solid #E2E8F0;
            border-left: none;
            border-radius: 0 6px 6px 0;
            padding: 10px 8px;
            cursor: pointer;
            color: #64748B;
            transition: all 0.3s;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .sidebar.collapsed {
            transform: translateX(-260px);
        }
        
        .sidebar.collapsed ~ .main-content-with-sidebar {
            margin-left: 0;
        }
        
        .sidebar.collapsed + .sidebar-toggle {
            left: 0;
        }
        
        .main-content-with-sidebar {
            margin-left: 260px;
            transition: margin-left 0.3s;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-260px);
            }
            
            .sidebar.active {
                transform: translateX(0);
                box-shadow: 0 0 20px rgba(0,0,0,0.1);
            }
            
            .sidebar-toggle {
                display: block;
                left: 0;
            }
            
            .sidebar.active + .sidebar-toggle {
                left: 260px;
            }
            
            .main-content-with-sidebar {
                margin-left: 0;
            }
        }
        
        /* CraneIQ Specific Styles */
        .signal-strength {
            display: flex;
            gap: 2px;
        }
        
        .signal-bar {
            width: 4px;
            border-radius: 1px;
        }
        
        .signal-bar.active {
            background-color: #10B981;
        }
        
        .signal-bar.inactive {
            background-color: #E2E8F0;
        }
        
        /* Custom file upload */
        .file-upload {
            border: 2px dashed #CBD5E1;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .file-upload:hover {
            border-color: #2563EB;
            background: #EFF6FF;
        }
        
        .file-upload input {
            display: none;
        }
        
        /* Smooth scroll offset */
        html {
            scroll-behavior: smooth;
        }
        
        /* Section highlight animation */
        @keyframes highlight {
            0% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(37, 99, 235, 0); }
            100% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0); }
        }
        
        .highlight-section {
            animation: highlight 2s ease;
            position: relative;
        }
    </style>
</head>
<body class="min-h-screen bg-slate-50">

    <!-- Sidebar will be inserted here by JavaScript -->
    <div id="sidebar-container"></div>

    <!-- Main Content Container -->
    <div class="main-content-with-sidebar">
        <!-- NEW HEADER: Univa Gateway Tag Mapping Header -->
        <header id="header" class="bg-white border-b border-border sticky top-0 z-30 shadow-sm">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
                <!-- Left: Logo & Breadcrumb -->
                <div class="flex items-center space-x-4">
                    <div class="hidden md:flex items-center text-sm text-slate-500 h-6">
                        <span><i class="fa-solid fa-plug mr-2"></i>Univa Gateway</span>
                        <i class="fa-solid fa-chevron-right text-xs mx-2"></i>
                        <span class="text-slate-900 font-medium" id="page-title">CraneIQ</span>
                    </div>
                </div>

                <!-- Right: Controls -->
                <div class="flex items-center space-x-4">
                    <div class="relative hidden sm:block">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fa-solid fa-server text-slate-400 text-sm"></i>
                        </div>
                        <select id="gateway-select" class="pl-9 pr-8 py-1.5 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary bg-slate-50 text-slate-700 font-medium cursor-pointer hover:bg-white transition-colors">
                            <option>Univa-GW-01</option>
                            <option>Univa-GW-02</option>
                            <option>Univa-GW-03</option>
                        </select>
                    </div>
                    <div class="h-6 w-px bg-slate-200 mx-2 hidden sm:block"></div>
                    <button class="text-slate-500 hover:text-slate-700 font-medium text-sm px-3 py-1.5 rounded-lg hover:bg-slate-100 transition-colors">
                        <i class="fa-solid fa-circle-question mr-2"></i> Help
                    </button>
                    
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-grow">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                <div class="mb-8">
                    <h1 class="text-2xl font-bold text-slate-900">CraneIQ Pro Configuration</h1>
                    <p class="text-slate-500 text-sm mt-1">Configure anti-collision systems, zoning, load monitoring, and crane safety parameters.</p>
                </div>

                <div class="space-y-8">
                    
                    <!-- SECTION 1: Crane Profile & Overview -->
                    <section id="crane-profile-section" class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Profile Card -->
                        <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                            <div class="flex justify-between items-start mb-6">
                                <div>
                                    <h2 class="text-lg font-semibold text-slate-800">Crane Profile</h2>
                                    <p class="text-xs text-slate-500 uppercase tracking-wider mt-1">ID: CRANE-01</p>
                                </div>
                                <span class="px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full border border-green-200">Online</span>
                            </div>
                            
                            <div class="space-y-4">
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-xs font-medium text-slate-700 mb-1">Crane Type</label>
                                        <select class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                            <option>Double-Girder EOT</option>
                                            <option>Single-Girder</option>
                                            <option>Gantry</option>
                                            <option>JIB</option>
                                            <option>Tower Crane</option>
                                            <option>RTG</option>
                                            <option>Portal Crane</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-slate-700 mb-1">Capacity</label>
                                        <div class="relative">
                                            <input type="text" value="25,000" class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500 pl-3 pr-10 py-2">
                                            <span class="absolute right-3 top-2 text-xs text-slate-500">kg</span>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-xs font-medium text-slate-700 mb-1">Operating Mode</label>
                                    <div class="flex bg-slate-100 rounded-md p-1 border border-slate-200">
                                        <button class="flex-1 py-2 text-xs font-medium rounded-md bg-blue-600 text-white shadow">Manual</button>
                                        <button class="flex-1 py-2 text-xs font-medium rounded-md text-slate-600 hover:bg-slate-50">Semi-Auto</button>
                                        <button class="flex-1 py-2 text-xs font-medium rounded-md text-slate-600 hover:bg-slate-50">Auto</button>
                                    </div>
                                </div>

                                <div class="pt-4 border-t border-slate-100">
                                    <div class="flex justify-between items-center text-sm mb-3">
                                        <span class="text-slate-600">Dimensions</span>
                                        <button class="text-blue-600 text-xs hover:text-blue-700 hover:underline">Edit Mapping</button>
                                    </div>
                                    <div class="grid grid-cols-3 gap-3 text-center">
                                        <div class="bg-slate-50 rounded-lg p-3 border border-slate-200">
                                            <div class="text-xs text-slate-500 mb-1">Span (X)</div>
                                            <div class="font-mono text-slate-900 text-sm">15.0m</div>
                                        </div>
                                        <div class="bg-slate-50 rounded-lg p-3 border border-slate-200">
                                            <div class="text-xs text-slate-500 mb-1">Travel (Y)</div>
                                            <div class="font-mono text-slate-900 text-sm">45.0m</div>
                                        </div>
                                        <div class="bg-slate-50 rounded-lg p-3 border border-slate-200">
                                            <div class="text-xs text-slate-500 mb-1">Height (Z)</div>
                                            <div class="font-mono text-slate-900 text-sm">12.0m</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Floor Layout & Coordinates Visualizer -->
                        <div class="lg:col-span-2 bg-white rounded-xl shadow-sm border border-slate-200 p-4 relative overflow-hidden">
                            <div class="flex justify-between items-center mb-4">
                                <div class="flex items-center gap-2">
                                    <i class="fa-solid fa-map-location-dot text-blue-600"></i>
                                    <h3 class="text-lg font-semibold text-slate-800">Floor Layout & Zones</h3>
                                </div>
                                <div class="flex gap-2">
                                    <button id="upload-layout-btn" class="px-3 py-1.5 text-sm font-medium bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-md transition-colors">
                                        <i class="fa-solid fa-upload mr-1"></i> Upload
                                    </button>
                                    <button class="px-3 py-1.5 text-sm font-medium bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-md transition-colors">
                                        <i class="fa-solid fa-expand"></i>
                                    </button>
                                </div>
                            </div>
                            <!-- Placeholder for CAD/Image -->
                            <div class="w-full h-64 bg-gradient-to-br from-slate-50 to-blue-50 rounded-lg border-2 border-dashed border-slate-300 flex items-center justify-center">
                                <div class="text-center">
                                    <i class="fa-solid fa-map text-4xl text-slate-300 mb-3"></i>
                                    <p class="text-sm text-slate-500">Upload or draw floor layout</p>
                                    <p class="text-xs text-slate-400 mt-1">Supports .dwg, .dxf, .png, .jpg</p>
                                </div>
                            </div>
                            <div class="mt-4 flex flex-wrap gap-2">
                                <div class="flex items-center gap-2">
                                    <div class="w-3 h-3 rounded-full bg-red-500"></div>
                                    <span class="text-xs text-slate-600">Restricted Zone</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                                    <span class="text-xs text-slate-600">Slow Down Zone</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <div class="w-3 h-3 rounded-full bg-green-500"></div>
                                    <span class="text-xs text-slate-600">Safe Zone</span>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- SECTION 2: Load Limiter Configuration -->
                    <section id="load-limiter-section" class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-lg bg-orange-100 flex items-center justify-center">
                                    <i class="fa-solid fa-weight-hanging text-orange-600"></i>
                                </div>
                                <div>
                                    <h3 class="text-lg font-semibold text-slate-800">Load Limiter Configuration</h3>
                                    <p class="text-xs text-slate-500">Configure load limits, warnings, and safety thresholds</p>
                                </div>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" checked class="sr-only peer">
                                <div class="w-11 h-6 bg-slate-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                            </label>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Basic Load Settings -->
                            <div class="space-y-4">
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-xs font-medium text-slate-700 mb-1">Rated Load</label>
                                        <div class="relative">
                                            <input type="text" value="25000" class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500 pl-3 pr-10 py-2">
                                            <span class="absolute right-3 top-2 text-xs text-slate-500">kg</span>
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-slate-700 mb-1">SWL</label>
                                        <div class="relative">
                                            <input type="text" value="100" class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500 pl-3 pr-10 py-2">
                                            <span class="absolute right-3 top-2 text-xs text-slate-500">%</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-xs font-medium text-slate-700 mb-1">Warning Threshold</label>
                                        <div class="relative">
                                            <input type="text" value="90" class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500 pl-3 pr-10 py-2">
                                            <span class="absolute right-3 top-2 text-xs text-slate-500">%</span>
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-slate-700 mb-1">Cutoff Threshold</label>
                                        <div class="relative">
                                            <input type="text" value="110" class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500 pl-3 pr-10 py-2">
                                            <span class="absolute right-3 top-2 text-xs text-slate-500">%</span>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-xs font-medium text-slate-700 mb-1">Signal Source</label>
                                    <select class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                        <option>Load Cell</option>
                                        <option>Current Sense</option>
                                        <option>Pressure Sensor</option>
                                        <option>Combined</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Advanced Load Settings -->
                            <div class="space-y-4">
                                <!-- Load Curve Upload -->
                                <div>
                                    <label class="block text-xs font-medium text-slate-700 mb-2">Load Curve</label>
                                    <div class="file-upload" id="load-curve-upload">
                                        <i class="fa-solid fa-file-arrow-up text-2xl text-slate-400 mb-2"></i>
                                        <p class="text-sm text-slate-600 mb-1">Upload load curve (.csv)</p>
                                        <p class="text-xs text-slate-400">Drag & drop or click to browse</p>
                                        <input type="file" accept=".csv" id="load-curve-file">
                                    </div>
                                </div>

                                <!-- Tilt Compensation -->
                                <div class="flex items-center justify-between">
                                    <div>
                                        <span class="text-sm text-slate-700">Tilt Compensation</span>
                                        <p class="text-xs text-slate-500">Compensate for crane tilt</p>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" checked class="sr-only peer">
                                        <div class="w-10 h-5 bg-slate-300 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"></div>
                                    </label>
                                </div>

                                <!-- Additional Features -->
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="flex items-center justify-between">
                                        <span class="text-sm text-slate-700">Shock Load Detect</span>
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" checked class="sr-only peer">
                                            <div class="w-10 h-5 bg-slate-300 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"></div>
                                        </label>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <span class="text-sm text-slate-700">Swing Detect</span>
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" checked class="sr-only peer">
                                            <div class="w-10 h-5 bg-slate-300 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"></div>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                                        <!-- SECTION 3: IoT Gateway Data Buffer -->
                    <section id="datalogger-section" class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center">
                                    <i class="fa-solid fa-database text-purple-600"></i>
                                </div>
                                <div>
                                    <h3 class="text-lg font-semibold text-slate-800">IoT Gateway Data Buffer</h3>
                                    <p class="text-xs text-slate-500">Configure individual data loggers for network outage buffering</p>
                                </div>
                            </div>
                            <button id="add-datalogger-btn" class="px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md shadow-sm transition-colors flex items-center gap-2">
                                <i class="fa-solid fa-plus"></i> Add Datalogger
                            </button>
                        </div>

                        <!-- Add Datalogger Modal -->
                        <div id="add-datalogger-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
                            <div class="bg-white rounded-lg shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto">
                                <div class="px-6 py-4 border-b border-slate-200">
                                    <h3 class="text-lg font-semibold text-slate-800">Add New Datalogger</h3>
                                    <p class="text-xs text-slate-500 mt-1">Configure data point logging for network outages</p>
                                </div>
                                <div class="px-6 py-4 space-y-4">
                                    <!-- Step 1: Select Device -->
                                    <div>
                                        <label class="block text-sm font-medium text-slate-700 mb-2">1. Select Device</label>
                                        <select id="logger-device-select" class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                            <option value="">-- Select a device --</option>
                                            <option value="load_cell">Load Cell System (LC-001)</option>
                                            <option value="anti_collision">Anti-Collision System (ACS-001)</option>
                                            <option value="emergency_stop">Emergency Stop Module (ESM-001)</option>
                                            <option value="hoist_motor">Hoist Motor Drive (HM-001)</option>
                                            <option value="trolley_motor">Trolley Motor Drive (TM-001)</option>
                                            <option value="bridge_motor">Bridge Motor Drive (BM-001)</option>
                                            <option value="encoder_x">X-Axis Encoder (ENC-X-01)</option>
                                            <option value="encoder_y">Y-Axis Encoder (ENC-Y-01)</option>
                                            <option value="encoder_z">Z-Axis Encoder (ENC-Z-01)</option>
                                            <option value="main_brake">Main Hoist Brake (BRK-H-01)</option>
                                            <option value="trolley_brake">Trolley Brake (BRK-T-01)</option>
                                            <option value="weather_station">Weather Station (WS-001)</option>
                                            <option value="vibration_sensor">Vibration Sensor (VS-001)</option>
                                            <option value="temperature_sensor">Temperature Sensor Array (TS-001)</option>
                                            <option value="wind_sensor">Wind Speed Sensor (WIND-001)</option>
                                        </select>
                                    </div>

                                    <!-- Step 2: Select Tag from Device -->
                                    <div>
                                        <label class="block text-sm font-medium text-slate-700 mb-2">2. Select Data Tag</label>
                                        <select id="logger-tag-select" class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500" disabled>
                                            <option value="">-- First select a device --</option>
                                        </select>
                                        <div id="tag-description" class="text-xs text-slate-500 mt-2 hidden">
                                            <i class="fa-solid fa-circle-info text-blue-500 mr-1"></i>
                                            <span id="tag-desc-text"></span>
                                            <span id="tag-address" class="ml-2 font-mono text-slate-600"></span>
                                        </div>
                                    </div>

                                    <!-- Step 3: Priority -->
                                    <div>
                                        <label class="block text-sm font-medium text-slate-700 mb-2">3. Set Priority</label>
                                        <div class="grid grid-cols-4 gap-2">
                                            <label class="flex flex-col items-center p-3 border rounded-lg cursor-pointer hover:bg-slate-50">
                                                <input type="radio" name="logger-priority" value="critical" class="h-4 w-4 text-red-600 border-slate-300 focus:ring-red-500">
                                                <div class="mt-2 text-center">
                                                    <span class="text-sm font-medium text-slate-700">Critical</span>
                                                    <div class="w-6 h-1 bg-red-500 rounded-full mx-auto mt-1"></div>
                                                </div>
                                            </label>
                                            <label class="flex flex-col items-center p-3 border rounded-lg cursor-pointer hover:bg-slate-50">
                                                <input type="radio" name="logger-priority" value="high" class="h-4 w-4 text-orange-600 border-slate-300 focus:ring-orange-500">
                                                <div class="mt-2 text-center">
                                                    <span class="text-sm font-medium text-slate-700">High</span>
                                                    <div class="w-6 h-1 bg-orange-500 rounded-full mx-auto mt-1"></div>
                                                </div>
                                            </label>
                                            <label class="flex flex-col items-center p-3 border rounded-lg cursor-pointer hover:bg-slate-50">
                                                <input type="radio" name="logger-priority" value="medium" checked class="h-4 w-4 text-yellow-600 border-slate-300 focus:ring-yellow-500">
                                                <div class="mt-2 text-center">
                                                    <span class="text-sm font-medium text-slate-700">Medium</span>
                                                    <div class="w-6 h-1 bg-yellow-500 rounded-full mx-auto mt-1"></div>
                                                </div>
                                            </label>
                                            <label class="flex flex-col items-center p-3 border rounded-lg cursor-pointer hover:bg-slate-50">
                                                <input type="radio" name="logger-priority" value="low" class="h-4 w-4 text-slate-600 border-slate-300 focus:ring-slate-500">
                                                <div class="mt-2 text-center">
                                                    <span class="text-sm font-medium text-slate-700">Low</span>
                                                    <div class="w-6 h-1 bg-slate-500 rounded-full mx-auto mt-1"></div>
                                                </div>
                                            </label>
                                        </div>
                                    </div>

                                    <!-- Step 4: Logging Condition -->
                                    <div>
                                        <label class="block text-sm font-medium text-slate-700 mb-2">4. Logging Condition</label>
                                        
                                        <!-- Condition Selection -->
                                        <div class="grid grid-cols-2 gap-3 mb-4">
                                            <label class="flex flex-col p-4 border rounded-lg cursor-pointer hover:bg-blue-50 hover:border-blue-300 transition-colors">
                                                <input type="radio" name="logger-condition" value="always" class="h-4 w-4 text-blue-600 border-slate-300 focus:ring-blue-500">
                                                <div class="mt-2">
                                                    <span class="text-sm font-medium text-slate-700">Always Log</span>
                                                    <p class="text-xs text-slate-500 mt-1">Continuous logging at sampling rate</p>
                                                </div>
                                            </label>
                                            <label class="flex flex-col p-4 border rounded-lg cursor-pointer hover:bg-blue-50 hover:border-blue-300 transition-colors">
                                                <input type="radio" name="logger-condition" value="on_change" class="h-4 w-4 text-blue-600 border-slate-300 focus:ring-blue-500">
                                                <div class="mt-2">
                                                    <span class="text-sm font-medium text-slate-700">On Change</span>
                                                    <p class="text-xs text-slate-500 mt-1">Log when value changes</p>
                                                </div>
                                            </label>
                                            <label class="flex flex-col p-4 border rounded-lg cursor-pointer hover:bg-blue-50 hover:border-blue-300 transition-colors">
                                                <input type="radio" name="logger-condition" value="threshold" class="h-4 w-4 text-blue-600 border-slate-300 focus:ring-blue-500">
                                                <div class="mt-2">
                                                    <span class="text-sm font-medium text-slate-700">Threshold</span>
                                                    <p class="text-xs text-slate-500 mt-1">Log when exceeds limits</p>
                                                </div>
                                            </label>
                                            <label class="flex flex-col p-4 border rounded-lg cursor-pointer hover:bg-blue-50 hover:border-blue-300 transition-colors">
                                                <input type="radio" name="logger-condition" value="periodic" checked class="h-4 w-4 text-blue-600 border-slate-300 focus:ring-blue-500">
                                                <div class="mt-2">
                                                    <span class="text-sm font-medium text-slate-700">Periodic</span>
                                                    <p class="text-xs text-slate-500 mt-1">Log at fixed intervals</p>
                                                </div>
                                            </label>
                                        </div>

                                        <!-- Condition Configuration -->
                                        <div id="condition-config" class="bg-slate-50 rounded-lg border border-slate-200 p-4 space-y-4">
                                            <!-- Always Log Configuration -->
                                            <div id="always-config" class="condition-panel">
                                                <div class="flex items-start gap-3">
                                                    <i class="fa-solid fa-play-circle text-blue-500 mt-0.5"></i>
                                                    <div>
                                                        <h5 class="text-sm font-medium text-slate-700">Continuous Logging</h5>
                                                        <p class="text-xs text-slate-500">Data will be logged continuously at the selected sampling rate</p>
                                                        <div class="mt-2 text-xs text-slate-600 bg-white p-2 rounded border border-slate-200">
                                                            <i class="fa-solid fa-info-circle text-blue-500 mr-1"></i>
                                                            Recommended for critical safety data that must not be missed
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- On Change Configuration -->
                                            <div id="on-change-config" class="condition-panel hidden">
                                                <div class="space-y-3">
                                                    <div class="flex items-start gap-3">
                                                        <i class="fa-solid fa-arrows-rotate text-blue-500 mt-0.5"></i>
                                                        <div>
                                                            <h5 class="text-sm font-medium text-slate-700">Change Detection</h5>
                                                            <p class="text-xs text-slate-500">Log when the value changes by specified amount</p>
                                                        </div>
                                                    </div>
                                                    <div class="grid grid-cols-2 gap-4">
                                                        <div>
                                                            <label class="block text-xs font-medium text-slate-600 mb-1">Change Type</label>
                                                            <select class="w-full text-xs border-slate-300 rounded shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                                                <option>Absolute Change</option>
                                                                <option>Percentage Change</option>
                                                                <option>Any Change</option>
                                                            </select>
                                                        </div>
                                                        <div>
                                                            <label class="block text-xs font-medium text-slate-600 mb-1">Change Amount</label>
                                                            <div class="flex items-center gap-2">
                                                                <input type="text" class="w-20 text-xs border-slate-300 rounded shadow-sm" placeholder="e.g., 5" value="5">
                                                                <span class="text-xs text-slate-500" id="change-unit">units</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="text-xs text-slate-600 bg-white p-2 rounded border border-slate-200">
                                                        <i class="fa-solid fa-lightbulb text-yellow-500 mr-1"></i>
                                                        Good for status flags, discrete values, and infrequent changes
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Threshold Configuration -->
                                            <div id="threshold-config" class="condition-panel hidden">
                                                <div class="space-y-3">
                                                    <div class="flex items-start gap-3">
                                                        <i class="fa-solid fa-chart-line text-blue-500 mt-0.5"></i>
                                                        <div>
                                                            <h5 class="text-sm font-medium text-slate-700">Threshold Settings</h5>
                                                            <p class="text-xs text-slate-500">Log when value crosses threshold limits</p>
                                                        </div>
                                                    </div>
                                                    <div class="grid grid-cols-2 gap-4">
                                                        <div>
                                                            <label class="block text-xs font-medium text-slate-600 mb-1">Condition</label>
                                                            <select class="w-full text-xs border-slate-300 rounded shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                                                <option>Greater than (>)</option>
                                                                <option>Less than (<)</option>
                                                                <option>Greater or equal (>=)</option>
                                                                <option>Less or equal (<=)</option>
                                                                <option>Between range</option>
                                                            </select>
                                                        </div>
                                                        <div>
                                                            <label class="block text-xs font-medium text-slate-600 mb-1">Threshold Value</label>
                                                            <div class="flex items-center gap-2">
                                                                <input type="text" class="w-20 text-xs border-slate-300 rounded shadow-sm" placeholder="Value" value="80">
                                                                <span class="text-xs text-slate-500" id="threshold-unit">%</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div id="range-config" class="hidden grid grid-cols-2 gap-4">
                                                        <div>
                                                            <label class="block text-xs font-medium text-slate-600 mb-1">Min Value</label>
                                                            <input type="text" class="w-full text-xs border-slate-300 rounded shadow-sm" placeholder="Minimum">
                                                        </div>
                                                        <div>
                                                            <label class="block text-xs font-medium text-slate-600 mb-1">Max Value</label>
                                                            <input type="text" class="w-full text-xs border-slate-300 rounded shadow-sm" placeholder="Maximum">
                                                        </div>
                                                    </div>
                                                    <div class="text-xs text-slate-600 bg-white p-2 rounded border border-slate-200">
                                                        <i class="fa-solid fa-bell text-red-500 mr-1"></i>
                                                        Ideal for alarms, warnings, and safety limit monitoring
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Periodic Configuration -->
                                            <div id="periodic-config" class="condition-panel">
                                                <div class="space-y-3">
                                                    <div class="flex items-start gap-3">
                                                        <i class="fa-solid fa-clock text-blue-500 mt-0.5"></i>
                                                        <div>
                                                            <h5 class="text-sm font-medium text-slate-700">Periodic Sampling</h5>
                                                            <p class="text-xs text-slate-500">Log data at regular time intervals</p>
                                                        </div>
                                                    </div>
                                                    <div class="grid grid-cols-2 gap-4">
                                                        <div>
                                                            <label class="block text-xs font-medium text-slate-600 mb-1">Interval</label>
                                                            <input type="number" min="1" value="10" class="w-full text-xs border-slate-300 rounded shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                                        </div>
                                                        <div>
                                                            <label class="block text-xs font-medium text-slate-600 mb-1">Time Unit</label>
                                                            <select class="w-full text-xs border-slate-300 rounded shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                                                <option>Seconds</option>
                                                                <option>Minutes</option>
                                                                <option>Hours</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="text-xs text-slate-600 bg-white p-2 rounded border border-slate-200">
                                                        <i class="fa-solid fa-wave-square text-green-500 mr-1"></i>
                                                        Best for trending, monitoring, and periodic data collection
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Step 5: Storage Configuration -->
                                    <div>
                                        <label class="block text-sm font-medium text-slate-700 mb-2">5. Storage Allocation</label>
                                        <div class="grid grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-xs font-medium text-slate-600 mb-1">Max Storage</label>
                                                <div class="flex items-center gap-2">
                                                    <input type="text" id="logger-storage-size" value="100" class="w-20 text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                                    <select id="logger-storage-unit" class="flex-1 text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                                        <option value="mb">MB</option>
                                                        <option value="gb">GB</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div>
                                                <label class="block text-xs font-medium text-slate-600 mb-1">Estimated Duration</label>
                                                <div class="text-sm font-medium text-slate-800" id="estimated-duration">~48 hours</div>
                                                <div class="text-xs text-slate-500">Based on sampling rate</div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Step 6: Sampling Rate -->
                                    <div>
                                        <label class="block text-sm font-medium text-slate-700 mb-2">6. Sampling Rate</label>
                                        <div class="grid grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-xs font-medium text-slate-600 mb-1">Interval</label>
                                                <select id="sampling-rate" class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                                    <option value="1000">1 second</option>
                                                    <option value="5000" selected>5 seconds</option>
                                                    <option value="10000">10 seconds</option>
                                                    <option value="30000">30 seconds</option>
                                                    <option value="60000">1 minute</option>
                                                    <option value="300000">5 minutes</option>
                                                    <option value="600000">10 minutes</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label class="block text-xs font-medium text-slate-600 mb-1">Data Format</label>
                                                <select id="data-format" class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                                    <option value="raw">Raw binary</option>
                                                    <option value="compressed" selected>Compressed</option>
                                                    <option value="csv">CSV text</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="px-6 py-4 border-t border-slate-200 flex justify-end gap-3">
                                    <button id="cancel-datalogger" class="px-4 py-2 text-sm font-medium text-slate-600 hover:text-slate-800 bg-white border border-slate-300 hover:border-slate-400 rounded-md transition-colors">
                                        Cancel
                                    </button>
                                    <button id="save-datalogger" class="px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md shadow-sm transition-colors">
                                        Create Datalogger
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Configured Loggers List -->
                        <div class="space-y-4">
                            <!-- Summary Stats -->
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
                                    <div class="text-xs text-blue-600 mb-1">Active Loggers</div>
                                    <div class="text-xl font-bold text-blue-700" id="active-loggers-count">0</div>
                                </div>
                                <div class="bg-green-50 rounded-lg p-4 border border-green-200">
                                    <div class="text-xs text-green-600 mb-1">Total Storage</div>
                                    <div class="text-xl font-bold text-green-700" id="total-storage">0 MB</div>
                                </div>
                                <div class="bg-purple-50 rounded-lg p-4 border border-purple-200">
                                    <div class="text-xs text-purple-600 mb-1">Data Rate</div>
                                    <div class="text-xl font-bold text-purple-700" id="total-data-rate">0 MB/h</div>
                                </div>
                                <div class="bg-amber-50 rounded-lg p-4 border border-amber-200">
                                    <div class="text-xs text-amber-600 mb-1">Buffer Health</div>
                                    <div class="text-xl font-bold text-amber-700" id="buffer-health">Good</div>
                                </div>
                            </div>

                            <!-- Loggers Table -->
                            <div class="border border-slate-200 rounded-lg overflow-hidden">
                                <div class="bg-slate-50 px-4 py-3 border-b border-slate-200">
                                    <h4 class="text-sm font-semibold text-slate-700">Configured Data Loggers</h4>
                                    <p class="text-xs text-slate-500 mt-1">Individual data point loggers for network outage buffering</p>
                                </div>
                                
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-slate-200">
                                        <thead class="bg-slate-50">
                                            <tr>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Device</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Tag</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Priority</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Condition</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Storage</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Sampling</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Status</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider w-24">Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="loggers-table-body" class="bg-white divide-y divide-slate-200">
                                            <!-- Loggers will be dynamically loaded here -->
                                            <tr id="no-loggers-row">
                                                <td colspan="8" class="px-4 py-8 text-center">
                                                    <i class="fa-solid fa-database text-3xl text-slate-300 mb-3"></i>
                                                    <p class="text-sm text-slate-500">No dataloggers configured yet</p>
                                                    <p class="text-xs text-slate-400 mt-1">Click "Add Datalogger" to create your first logger</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </section>
                    <!-- SECTION 4: Safety Systems (ACS & Zoning) -->
                    <section id="safety-configuration" class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        
                        <!-- Anti-Collision System (ACS) -->
                        <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                            <div class="flex items-center justify-between mb-6">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-lg bg-red-100 flex items-center justify-center">
                                        <i class="fa-solid fa-shield-halved text-red-600"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold text-slate-800">Anti-Collision System</h3>
                                        <p class="text-xs text-slate-500">Crane-to-Crane & Object Detection</p>
                                    </div>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" checked class="sr-only peer">
                                    <div class="w-11 h-6 bg-slate-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                </label>
                            </div>

                            <div class="space-y-5">
                                <!-- Geometry Input -->
                                <div class="bg-slate-50 rounded-lg p-4 border border-slate-200">
                                    <h4 class="text-sm font-medium text-slate-700 mb-3">Crane Geometry</h4>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-xs font-medium text-slate-600 mb-1">Boom Length</label>
                                            <div class="relative">
                                                <input type="text" value="30.0" class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500 pl-3 pr-10 py-2">
                                                <span class="absolute right-3 top-2 text-xs text-slate-500">m</span>
                                            </div>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-slate-600 mb-1">Jib Angle</label>
                                            <div class="relative">
                                                <input type="text" value="45.0" class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500 pl-3 pr-10 py-2">
                                                <span class="absolute right-3 top-2 text-xs text-slate-500"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Sensor Config -->
                                <div class="bg-slate-50 rounded-lg p-4 border border-slate-200">
                                    <h4 class="text-sm font-medium text-slate-700 mb-3">Detection Settings</h4>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-xs font-medium text-slate-600 mb-1">Sensor Tech</label>
                                            <select class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                                <option>Laser LiDAR</option>
                                                <option>Radar</option>
                                                <option>Ultrasonic</option>
                                                <option>Camera Vision</option>
                                                <option>Combined</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-slate-600 mb-1">Comm. Protocol</label>
                                            <select class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                                <option>Wireless (RF)</option>
                                                <option>CAN Bus</option>
                                                <option>EtherCAT</option>
                                                <option>Wireless Mesh</option>
                                                <option>Profinet</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <!-- Distances -->
                                <div>
                                    <div class="flex justify-between text-sm text-slate-600 mb-2">
                                        <span>Warning Distance</span>
                                        <span class="font-medium">6.0 m</span>
                                    </div>
                                    <div class="w-full bg-slate-200 rounded-full h-2 mb-4">
                                        <div class="bg-yellow-400 h-2 rounded-full" style="width: 60%"></div>
                                    </div>
                                    
                                    <div class="flex justify-between text-sm text-slate-600 mb-2">
                                        <span>Slow-Down Distance</span>
                                        <span class="font-medium">4.0 m</span>
                                    </div>
                                    <div class="w-full bg-slate-200 rounded-full h-2 mb-4">
                                        <div class="bg-yellow-500 h-2 rounded-full" style="width: 40%"></div>
                                    </div>
                                    
                                    <div class="flex justify-between text-sm text-slate-600 mb-2">
                                        <span>Critical Stop Distance</span>
                                        <span class="font-medium">2.0 m</span>
                                    </div>
                                    <div class="w-full bg-slate-200 rounded-full h-2">
                                        <div class="bg-red-500 h-2 rounded-full" style="width: 20%"></div>
                                    </div>
                                </div>

                                <!-- Paired Cranes -->
                                <div>
                                    <h4 class="text-sm font-medium text-slate-700 mb-2">Paired Cranes</h4>
                                    <div class="flex flex-wrap gap-2">
                                        <span class="px-3 py-1.5 bg-slate-100 border border-slate-300 rounded-md text-sm text-slate-700 flex items-center gap-2">
                                            Crane-02 <i class="fa-solid fa-link text-green-600"></i>
                                        </span>
                                        <span class="px-3 py-1.5 bg-slate-100 border border-slate-300 rounded-md text-sm text-slate-700 flex items-center gap-2">
                                            Crane-03 <i class="fa-solid fa-link text-green-600"></i>
                                        </span>
                                        <span class="px-3 py-1.5 bg-slate-100 border border-slate-300 rounded-md text-sm text-slate-700 flex items-center gap-2">
                                            Crane-04 <i class="fa-solid fa-unlink text-red-600"></i>
                                        </span>
                                        <button id="add-peer-btn" class="px-3 py-1.5 bg-white border border-slate-300 border-dashed rounded-md text-sm text-slate-600 hover:text-slate-800 hover:border-slate-400 transition flex items-center gap-2">
                                            <i class="fa-solid fa-plus"></i> Add Peer
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Zoning Configuration -->
                        <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                            <div class="flex items-center justify-between mb-6">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center">
                                        <i class="fa-solid fa-draw-polygon text-blue-600"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold text-slate-800">Zoning Configuration</h3>
                                        <p class="text-xs text-slate-500">Restricted Areas & Speed Limits</p>
                                    </div>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" checked class="sr-only peer">
                                    <div class="w-11 h-6 bg-slate-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                </label>
                            </div>

                            <div class="space-y-4">
                                <!-- Zone Input -->
                                <div class="bg-slate-50 rounded-lg p-4 border border-slate-200">
                                    <div class="flex justify-between items-center mb-3">
                                        <h4 class="text-sm font-medium text-slate-700">Add New Zone</h4>
                                        <button id="add-zone-btn" class="text-blue-600 text-sm hover:text-blue-700 hover:underline flex items-center gap-1">
                                            <i class="fa-solid fa-plus"></i> New Zone
                                        </button>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4 mb-3">
                                        <div>
                                            <label class="block text-xs font-medium text-slate-600 mb-1">Zone Type</label>
                                            <select class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                                <option>No-Go (Restricted)</option>
                                                <option>Slow Zone (Speed Limit)</option>
                                                <option>Warning Only</option>
                                                <option>Safe Zone</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-xs font-medium text-slate-600 mb-1">Priority</label>
                                            <select class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                                <option>Low</option>
                                                <option>Medium</option>
                                                <option>High</option>
                                                <option>Critical</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-slate-600 mb-1">Coordinates/Dimensions</label>
                                        <textarea class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500 h-20" placeholder="Enter coordinates or dimensions (X1,Y1,X2,Y2,Height)"></textarea>
                                    </div>
                                </div>

                                <!-- Zone List -->
                                <div class="bg-slate-50 rounded-lg border border-slate-200 overflow-hidden">
                                    <div class="p-3 border-b border-slate-200 flex justify-between items-center bg-white">
                                        <span class="text-sm font-semibold text-slate-700">Active Zones</span>
                                        <span class="text-xs text-slate-500">3 zones configured</span>
                                    </div>
                                    <div class="divide-y divide-slate-200 max-h-48 overflow-y-auto">
                                        <div class="p-3 flex items-center justify-between hover:bg-slate-100/50 transition">
                                            <div class="flex items-center gap-3">
                                                <div class="w-3 h-3 rounded-full bg-red-500"></div>
                                                <div>
                                                    <div class="text-sm text-slate-800 font-medium">Chemical Storage</div>
                                                    <div class="text-xs text-slate-500">Type: No-Go  Priority: High  Coordinates: 10,20,30,40,8</div>
                                                </div>
                                            </div>
                                            <button class="text-slate-400 hover:text-slate-600 p-1 rounded hover:bg-slate-200">
                                                <i class="fa-solid fa-pen text-xs"></i>
                                            </button>
                                        </div>
                                        <div class="p-3 flex items-center justify-between hover:bg-slate-100/50 transition">
                                            <div class="flex items-center gap-3">
                                                <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                                                <div>
                                                    <div class="text-sm text-slate-800 font-medium">Mezzanine Floor</div>
                                                    <div class="text-xs text-slate-500">Type: Slow Zone (20%)  Priority: Medium</div>
                                                </div>
                                            </div>
                                            <button class="text-slate-400 hover:text-slate-600 p-1 rounded hover:bg-slate-200">
                                                <i class="fa-solid fa-pen text-xs"></i>
                                            </button>
                                        </div>
                                        <div class="p-3 flex items-center justify-between hover:bg-slate-100/50 transition">
                                            <div class="flex items-center gap-3">
                                                <div class="w-3 h-3 rounded-full bg-green-500"></div>
                                                <div>
                                                    <div class="text-sm text-slate-800 font-medium">Loading Bay</div>
                                                    <div class="text-xs text-slate-500">Type: Warning Only  Priority: Low</div>
                                                </div>
                                            </div>
                                            <button class="text-slate-400 hover:text-slate-600 p-1 rounded hover:bg-slate-200">
                                                <i class="fa-solid fa-pen text-xs"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="grid grid-cols-2 gap-4">
                                    <div class="bg-slate-50 rounded-lg p-4 border border-slate-200">
                                        <label class="block text-sm font-medium text-slate-700 mb-2">Violation Action</label>
                                        <select class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                                            <option>Hard Stop</option>
                                            <option>Slow Down</option>
                                            <option>Alarm Only</option>
                                            <option>Log Only</option>
                                            <option>Gradual Stop</option>
                                        </select>
                                    </div>
                                    <div class="bg-slate-50 rounded-lg p-4 border border-slate-200">
                                        <label class="block text-sm font-medium text-slate-700 mb-2">Override Mode</label>
                                        <div class="flex items-center justify-between">
                                            <span class="text-sm text-slate-600">Auth Required</span>
                                            <i class="fa-solid fa-key text-yellow-500"></i>
                                        </div>
                                        <p class="text-xs text-slate-500 mt-1">Admin PIN needed for override</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- SECTION 5: Health & Load Monitoring -->
                    <section id="health-monitoring" class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-lg bg-emerald-100 flex items-center justify-center">
                                    <i class="fa-solid fa-heart-pulse text-emerald-600"></i>
                                </div>
                                <div>
                                    <h3 class="text-lg font-semibold text-slate-800">Health & Load Intelligence</h3>
                                    <p class="text-xs text-slate-500">Load monitoring, wear detection</p>
                                </div>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" checked class="sr-only peer">
                                <div class="w-11 h-6 bg-slate-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                            </label>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                            
                            <!-- Load Monitoring Card -->
                            <div class="bg-slate-50 rounded-lg border border-slate-200 p-5">
                                <div class="flex justify-between items-center mb-4">
                                    <h4 class="font-medium text-slate-800">Load Monitoring</h4>
                                    <i class="fa-solid fa-weight-hanging text-blue-600"></i>
                                </div>
                                
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-xs font-medium text-slate-600 mb-2">Overload Thresholds</label>
                                        <div class="flex items-center gap-2">
                                            <div class="bg-white px-3 py-2 rounded border border-slate-300 flex-1 text-center">
                                                <span class="text-sm font-medium text-yellow-600">90%</span>
                                                <div class="text-xs text-slate-500">Warning</div>
                                            </div>
                                            <div class="bg-white px-3 py-2 rounded border border-slate-300 flex-1 text-center">
                                                <span class="text-sm font-medium text-red-600">110%</span>
                                                <div class="text-xs text-slate-500">Trip</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-center justify-between text-sm py-2 border-t border-slate-200">
                                        <span class="text-slate-600">Shock Load Detect</span>
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" checked class="sr-only peer">
                                            <div class="w-10 h-5 bg-slate-300 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"></div>
                                        </label>
                                    </div>
                                    <div class="flex items-center justify-between text-sm py-2 border-t border-slate-200">
                                        <span class="text-slate-600">Swing Detect</span>
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" checked class="sr-only peer">
                                            <div class="w-10 h-5 bg-slate-300 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"></div>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Motor Health -->
                            <div class="bg-slate-50 rounded-lg border border-slate-200 p-5">
                                <div class="flex justify-between items-center mb-4">
                                    <h4 class="font-medium text-slate-800">Motor Health</h4>
                                    <i class="fa-solid fa-gear text-emerald-600"></i>
                                </div>
                                
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-xs font-medium text-slate-600 mb-2">Motor Types</label>
                                        <div class="space-y-2">
                                            <div class="flex items-center justify-between text-sm">
                                                <span class="text-slate-600">LT Motor</span>
                                                <span class="font-medium text-slate-800">65C</span>
                                            </div>
                                            <div class="flex items-center justify-between text-sm">
                                                <span class="text-slate-600">CT Motor</span>
                                                <span class="font-medium text-slate-800">72C</span>
                                            </div>
                                            <div class="flex items-center justify-between text-sm">
                                                <span class="text-slate-600">MH Motor</span>
                                                <span class="font-medium text-slate-800">58C</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-xs font-medium text-slate-600 mb-2">Temperature Alert</label>
                                        <div class="flex items-center gap-2">
                                            <div class="bg-white px-3 py-2 rounded border border-slate-300 flex-1 text-center">
                                                <span class="text-sm font-medium text-yellow-600">75C</span>
                                                <div class="text-xs text-slate-500">Warning</div>
                                            </div>
                                            <div class="bg-white px-3 py-2 rounded border border-slate-300 flex-1 text-center">
                                                <span class="text-sm font-medium text-red-600">90C</span>
                                                <div class="text-xs text-slate-500">Shutdown</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-xs font-medium text-slate-600 mb-2">Vibration Limits</label>
                                        <div class="space-y-2">
                                            <div class="flex items-center justify-between text-sm">
                                                <span class="text-slate-600">RMS Limit</span>
                                                <input type="text" value="4.2" class="w-16 text-sm border-slate-300 rounded px-2 py-1 text-right">
                                            </div>
                                            <div class="flex items-center justify-between text-sm">
                                                <span class="text-slate-600">Peak Limit</span>
                                                <input type="text" value="6.5" class="w-16 text-sm border-slate-300 rounded px-2 py-1 text-right">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Brake Monitoring -->
                            <div class="bg-slate-50 rounded-lg border border-slate-200 p-5">
                                <div class="flex justify-between items-center mb-4">
                                    <h4 class="font-medium text-slate-800">Brake Monitoring</h4>
                                    <i class="fa-solid fa-stop-circle text-red-600"></i>
                                </div>
                                
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-xs font-medium text-slate-600 mb-2">Brake Coil Current</label>
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-xs text-slate-500">Normal Range</span>
                                            <span class="text-sm font-medium text-slate-800">2.5 - 3.5 A</span>
                                        </div>
                                        <div class="w-full bg-slate-200 rounded-full h-2">
                                            <div class="bg-green-500 h-2 rounded-full" style="width: 70%"></div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-xs font-medium text-slate-600 mb-2">Wear Threshold</label>
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-xs text-slate-500">Current</span>
                                            <span class="text-sm font-medium text-slate-800">12% worn</span>
                                        </div>
                                        <div class="w-full bg-slate-200 rounded-full h-2">
                                            <div class="bg-green-500 h-2 rounded-full" style="width: 12%"></div>
                                        </div>
                                    </div>
                                    
                                    <div class="pt-3 border-t border-slate-200">
                                        <div class="flex items-center justify-between text-sm">
                                            <div>
                                                <span class="text-slate-600">Brake Release Time</span>
                                                <p class="text-xs text-slate-500">Expected: 120ms</p>
                                            </div>
                                            <input type="text" value="115" class="w-16 text-sm border-slate-300 rounded px-2 py-1 text-right">
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-center justify-between text-sm pt-2">
                                        <span class="text-slate-600">Slippage Detection</span>
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" checked class="sr-only peer">
                                            <div class="w-10 h-5 bg-slate-300 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"></div>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            
                        </div>
                    </section>
                    <!-- SECTION 6: Rule Engine Integration - VIEW ONLY -->
                    <section id="rule-engine-section" class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded-lg bg-indigo-100 flex items-center justify-center">
                                    <i class="fa-solid fa-sitemap text-indigo-600 text-sm"></i>
                                </div>
                                <div>
                                    <h3 class="text-md font-semibold text-slate-800">Rule Engine Integration</h3>
                                    <p class="text-xs text-slate-500">Auto-generated safety rules from configurations</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-2">
                                <span class="text-xs text-slate-500 bg-slate-100 px-2 py-1 rounded-full">View Only</span>
                                <i class="fa-solid fa-eye text-blue-500 text-sm"></i>
                            </div>
                        </div>
                        
                        <!-- Info Box -->
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4">
                            <div class="flex items-start gap-2">
                                <i class="fa-solid fa-circle-info text-blue-500 text-sm mt-0.5"></i>
                                <div>
                                    <h4 class="text-sm font-medium text-blue-800 mb-1">Auto-Generated Rules</h4>
                                    <p class="text-xs text-blue-600">
                                        Rules are automatically created from your safety configurations. To modify rules, update the corresponding safety parameters.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Rules Summary -->
                        <div class="mb-4">
                            <div class="flex items-center justify-between mb-3">
                                <h4 class="text-sm font-medium text-slate-700">Active Rules (6)</h4>
                                <span class="text-xs text-slate-500">Auto-generated from safety configurations</span>
                            </div>
                            
                            <!-- Rules Grid -->
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                                <!-- Rule 1 -->
                                <div class="p-3 bg-slate-50 border border-slate-200 rounded-lg hover:bg-slate-100 transition-colors">
                                    <div class="flex items-center gap-2 mb-1">
                                        <i class="fa-solid fa-weight-hanging text-blue-500 text-xs"></i>
                                        <div class="text-sm font-medium text-slate-800">Load Limiter Rule</div>
                                        <span class="px-1.5 py-0.5 bg-blue-100 text-blue-700 text-xs font-medium rounded">Auto</span>
                                    </div>
                                    <div class="text-xs text-slate-600 mb-1">IF Load > 90% THEN Trigger Alarm</div>
                                    <div class="text-xs text-slate-500">Source: Load Limiter Configuration</div>
                                </div>
                                
                                <!-- Rule 2 -->
                                <div class="p-3 bg-slate-50 border border-slate-200 rounded-lg hover:bg-slate-100 transition-colors">
                                    <div class="flex items-center gap-2 mb-1">
                                        <i class="fa-solid fa-temperature-high text-red-500 text-xs"></i>
                                        <div class="text-sm font-medium text-slate-800">Motor Temperature</div>
                                        <span class="px-1.5 py-0.5 bg-red-100 text-red-700 text-xs font-medium rounded">Auto</span>
                                    </div>
                                    <div class="text-xs text-slate-600 mb-1">IF Temp >= 75C THEN Send Alert</div>
                                    <div class="text-xs text-slate-500">Source: Health Monitoring</div>
                                </div>
                                
                                <!-- Rule 3 -->
                                <div class="p-3 bg-slate-50 border border-slate-200 rounded-lg hover:bg-slate-100 transition-colors">
                                    <div class="flex items-center gap-2 mb-1">
                                        <i class="fa-solid fa-draw-polygon text-green-500 text-xs"></i>
                                        <div class="text-sm font-medium text-slate-800">Zone Violation</div>
                                        <span class="px-1.5 py-0.5 bg-green-100 text-green-700 text-xs font-medium rounded">Auto</span>
                                    </div>
                                    <div class="text-xs text-slate-600 mb-1">IF Zone Violation THEN Stop Motion</div>
                                    <div class="text-xs text-slate-500">Source: Zoning Configuration</div>
                                </div>
                                
                                <!-- Rule 4 -->
                                <div class="p-3 bg-slate-50 border border-slate-200 rounded-lg hover:bg-slate-100 transition-colors">
                                    <div class="flex items-center gap-2 mb-1">
                                        <i class="fa-solid fa-shield-halved text-purple-500 text-xs"></i>
                                        <div class="text-sm font-medium text-slate-800">Anti-Collision</div>
                                        <span class="px-1.5 py-0.5 bg-purple-100 text-purple-700 text-xs font-medium rounded">Auto</span>
                                    </div>
                                    <div class="text-xs text-slate-600 mb-1">IF Distance <= 2.0m THEN Emergency Stop</div>
                                    <div class="text-xs text-slate-500">Source: Anti-Collision System</div>
                                </div>
                            </div>
                        </div>

                        <!-- Rule Sources -->
                        <div class="bg-slate-50 rounded-lg border border-slate-200 p-3">
                            <h4 class="text-sm font-medium text-slate-700 mb-2">Rule Sources</h4>
                            <div class="grid grid-cols-2 sm:grid-cols-4 gap-2">
                                <a href="#load-limiter-section" class="flex items-center justify-between p-2 hover:bg-white rounded border border-slate-200 transition text-xs">
                                    <div class="flex items-center gap-2">
                                        <div class="w-2 h-2 rounded bg-blue-500"></div>
                                        <span class="text-slate-700">Load Limiter</span>
                                    </div>
                                    <span class="text-slate-500">2 rules</span>
                                </a>
                                <a href="#safety-configuration" class="flex items-center justify-between p-2 hover:bg-white rounded border border-slate-200 transition text-xs">
                                    <div class="flex items-center gap-2">
                                        <div class="w-2 h-2 rounded bg-green-500"></div>
                                        <span class="text-slate-700">Zone Control</span>
                                    </div>
                                    <span class="text-slate-500">3 rules</span>
                                </a>
                                <a href="#safety-configuration" class="flex items-center justify-between p-2 hover:bg-white rounded border border-slate-200 transition text-xs">
                                    <div class="flex items-center gap-2">
                                        <div class="w-2 h-2 rounded bg-red-500"></div>
                                        <span class="text-slate-700">Anti-Collision</span>
                                    </div>
                                    <span class="text-slate-500">2 rules</span>
                                </a>
                                <a href="#health-monitoring" class="flex items-center justify-between p-2 hover:bg-white rounded border border-slate-200 transition text-xs">
                                    <div class="flex items-center gap-2">
                                        <div class="w-2 h-2 rounded bg-emerald-500"></div>
                                        <span class="text-slate-700">Health Monitor</span>
                                    </div>
                                    <span class="text-slate-500">4 rules</span>
                                </a>
                            </div>
                        </div>
                    </section>

                   
                </div>
            </div>
        </main>

        <!-- Footer Actions -->
        <footer class="bg-white border-t border-slate-200 mt-8">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                <div class="flex justify-end space-x-4">
                    <button id="test-btn" class="px-5 py-2.5 text-sm font-medium bg-white border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors">
                        <i class="fa-solid fa-plug mr-2"></i> Test Connection
                    </button>
                    <button id="footer-reset-btn" class="px-5 py-2.5 text-sm font-medium text-slate-600 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors">
                        <i class="fa-solid fa-rotate-left mr-2"></i> Reset to Default
                    </button>
                    <button id="footer-cancel-btn" class="px-5 py-2.5 text-sm font-medium bg-white border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors">
                        Cancel
                    </button>
                    <button id="footer-save-btn" class="px-6 py-2.5 text-sm font-medium bg-blue-600 hover:bg-blue-700 text-white rounded-md shadow-sm transition-colors">
                        <i class="fa-solid fa-floppy-disk mr-2"></i> Save Configuration
                    </button>
                </div>
            </div>
        </footer>
    </div> <!-- End of main content container -->

    <!-- Notification Container -->
    <div id="notification-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

    <script>
        // Datalogger Configuration
function initializeDatalogger() {
    let dataloggers = [];
    
    // Device and tag database
    const deviceDatabase = {
        load_cell: {
            name: "Load Cell System",
            id: "LC-001",
            tags: [
                { id: "load_actual", name: "Load_Actual", address: "%MW100", description: "Actual load weight", type: "Float32", unit: "kg" },
                { id: "load_percent", name: "Load_Percent", address: "%MW102", description: "Load percentage of SWL", type: "Float32", unit: "%" },
                { id: "load_status", name: "Load_Status", address: "%MX10.0", description: "Load limiter status", type: "UInt16", unit: "" }
            ]
        },
        anti_collision: {
            name: "Anti-Collision System",
            id: "ACS-001",
            tags: [
                { id: "acs_distance", name: "ACS_Distance", address: "%MW200", description: "Minimum distance to object", type: "Float32", unit: "m" },
                { id: "acs_status", name: "ACS_Status", address: "%MX20.0", description: "ACS operational status", type: "UInt16", unit: "" }
            ]
        },
        hoist_motor: {
            name: "Hoist Motor Drive",
            id: "HM-001",
            tags: [
                { id: "motor_temp", name: "Motor_Temperature", address: "%MW300", description: "Motor winding temperature", type: "Float32", unit: "C" },
                { id: "motor_current", name: "Motor_Current", address: "%MW302", description: "Motor current draw", type: "Float32", unit: "A" }
            ]
        },
        encoder_x: {
            name: "X-Axis Encoder",
            id: "ENC-X-01",
            tags: [
                { id: "pos_x", name: "Position_X", address: "%MW400", description: "Bridge travel position", type: "Float32", unit: "m" }
            ]
        },
        main_brake: {
            name: "Main Hoist Brake",
            id: "BRK-H-01",
            tags: [
                { id: "brake_status", name: "Brake_Status", address: "%MX40.0", description: "Brake engagement status", type: "Boolean", unit: "" }
            ]
        },
        weather_station: {
            name: "Weather Station",
            id: "WS-001",
            tags: [
                { id: "wind_speed", name: "Wind_Speed", address: "%MW600", description: "Wind speed measurement", type: "Float32", unit: "m/s" }
            ]
        }
    };

    // Priority colors
    const priorityColors = {
        critical: { bg: 'bg-red-100', text: 'text-red-800', border: 'border-red-200' },
        high: { bg: 'bg-orange-100', text: 'text-orange-800', border: 'border-orange-200' },
        medium: { bg: 'bg-yellow-100', text: 'text-yellow-800', border: 'border-yellow-200' },
        low: { bg: 'bg-slate-100', text: 'text-slate-800', border: 'border-slate-200' }
    };

    // Condition display names
    const conditionDisplay = {
        always: "Always Log",
        on_change: "On Change",
        threshold: "Threshold",
        periodic: "Periodic"
    };

    // Initialize modal functionality
    function initializeModal() {
        const modal = document.getElementById('add-datalogger-modal');
        const addBtn = document.getElementById('add-datalogger-btn');
        const cancelBtn = document.getElementById('cancel-datalogger');
        const saveBtn = document.getElementById('save-datalogger');
        const deviceSelect = document.getElementById('logger-device-select');
        const tagSelect = document.getElementById('logger-tag-select');
        
        // Open modal
        addBtn.addEventListener('click', () => {
            modal.classList.remove('hidden');
        });
        
        // Close modal
        cancelBtn.addEventListener('click', () => {
            modal.classList.add('hidden');
            resetModal();
        });
        
        // Close modal on background click
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.classList.add('hidden');
                resetModal();
            }
        });
        
        // Device selection change
        deviceSelect.addEventListener('change', () => {
            const deviceId = deviceSelect.value;
            
            // Clear and enable tag select
            tagSelect.innerHTML = '<option value="">-- Select a data tag --</option>';
            tagSelect.disabled = !deviceId;
            
            if (deviceId && deviceDatabase[deviceId]) {
                const device = deviceDatabase[deviceId];
                
                // Add device tags to select
                device.tags.forEach(tag => {
                    const option = document.createElement('option');
                    option.value = tag.id;
                    option.textContent = `${tag.name} (${tag.address})`;
                    tagSelect.appendChild(option);
                });
                
                // Enable tag selection
                tagSelect.disabled = false;
            }
        });
        
        // Tag selection change
        tagSelect.addEventListener('change', () => {
            const deviceId = deviceSelect.value;
            const tagId = tagSelect.value;
            const descDiv = document.getElementById('tag-description');
            
            if (deviceId && tagId && deviceDatabase[deviceId]) {
                const device = deviceDatabase[deviceId];
                const tag = device.tags.find(t => t.id === tagId);
                
                if (tag) {
                    document.getElementById('tag-desc-text').textContent = tag.description;
                    document.getElementById('tag-address').textContent = `Address: ${tag.address}`;
                    descDiv.classList.remove('hidden');
                    
                    // Update units in condition panels
                    document.getElementById('change-unit').textContent = tag.unit || 'units';
                    document.getElementById('threshold-unit').textContent = tag.unit || 'units';
                    
                    // Auto-set priority based on device type
                    if (deviceId.includes('load') || deviceId.includes('anti') || deviceId.includes('emergency')) {
                        document.querySelector('input[name="logger-priority"][value="critical"]').checked = true;
                    } else if (deviceId.includes('motor') || deviceId.includes('brake')) {
                        document.querySelector('input[name="logger-priority"][value="high"]').checked = true;
                    } else if (deviceId.includes('encoder') || deviceId.includes('position')) {
                        document.querySelector('input[name="logger-priority"][value="medium"]').checked = true;
                    } else {
                        document.querySelector('input[name="logger-priority"][value="low"]').checked = true;
                    }
                }
            } else {
                descDiv.classList.add('hidden');
            }
        });
        
        // Logging Condition Radio Buttons
        const conditionRadios = document.querySelectorAll('input[name="logger-condition"]');
        conditionRadios.forEach(radio => {
            radio.addEventListener('change', () => {
                const selectedCondition = radio.value;
                
                // Hide all condition panels
                document.querySelectorAll('.condition-panel').forEach(panel => {
                    panel.classList.add('hidden');
                });
                
                // Show selected condition panel
                const selectedPanel = document.getElementById(`${selectedCondition}-config`);
                if (selectedPanel) {
                    selectedPanel.classList.remove('hidden');
                }
            });
        });
        
        // Threshold condition type change
        const thresholdConditionSelect = document.querySelector('#threshold-config select');
        if (thresholdConditionSelect) {
            thresholdConditionSelect.addEventListener('change', function() {
                const rangeConfig = document.getElementById('range-config');
                if (this.value === 'Between range') {
                    rangeConfig.classList.remove('hidden');
                } else {
                    rangeConfig.classList.add('hidden');
                }
            });
        }
        
        // Storage calculation
        const storageSizeInput = document.getElementById('logger-storage-size');
        const storageUnitSelect = document.getElementById('logger-storage-unit');
        const samplingRateSelect = document.getElementById('sampling-rate');
        
        function updateEstimate() {
            const size = parseFloat(storageSizeInput.value) || 100;
            const unit = storageUnitSelect.value;
            const sampling = parseInt(samplingRateSelect.value) || 5000;
            
            // Convert to MB
            const storageMB = unit === 'gb' ? size * 1024 : size;
            
            // Simple estimation: 4 bytes per sample (Float32)
            const bytesPerSample = 4;
            const samplesPerHour = (3600000 / sampling); // milliseconds in hour / sampling rate
            const mbPerHour = (bytesPerSample * samplesPerHour) / (1024 * 1024);
            
            const estimatedHours = storageMB / mbPerHour;
            
            document.getElementById('estimated-duration').textContent = 
                estimatedHours >= 8760 ? '>1 year' : 
                estimatedHours >= 720 ? `${Math.round(estimatedHours/24)} days` :
                estimatedHours >= 24 ? `${Math.round(estimatedHours/24)} days` :
                `${Math.round(estimatedHours)} hours`;
        }
        
        storageSizeInput.addEventListener('input', updateEstimate);
        storageUnitSelect.addEventListener('change', updateEstimate);
        samplingRateSelect.addEventListener('change', updateEstimate);
        
        // Initialize estimate
        updateEstimate();
        
        // Save datalogger
        saveBtn.addEventListener('click', () => {
            const deviceId = deviceSelect.value;
            const tagId = tagSelect.value;
            const priority = document.querySelector('input[name="logger-priority"]:checked').value;
            const condition = document.querySelector('input[name="logger-condition"]:checked').value;
            const storageSize = storageSizeInput.value;
            const storageUnit = storageUnitSelect.value;
            const samplingRate = parseInt(samplingRateSelect.value);
            const dataFormat = document.getElementById('data-format').value;
            
            if (!deviceId || !tagId) {
                alert('Please select both device and tag');
                return;
            }
            
            if (!deviceDatabase[deviceId]) {
                alert('Invalid device selected');
                return;
            }
            
            const device = deviceDatabase[deviceId];
            const tag = device.tags.find(t => t.id === tagId);
            
            if (!tag) {
                alert('Invalid tag selected');
                return;
            }
            
            // Get condition details
            let conditionDetails = '';
            if (condition === 'on_change') {
                const changeType = document.querySelector('#on-change-config select').value;
                const changeAmount = document.querySelector('#on-change-config input[type="text"]').value;
                conditionDetails = `${changeType}: ${changeAmount} ${tag.unit}`;
            } else if (condition === 'threshold') {
                const thresholdType = document.querySelector('#threshold-config select').value;
                const thresholdValue = document.querySelector('#threshold-config input[type="text"]').value;
                conditionDetails = `${thresholdType} ${thresholdValue} ${tag.unit}`;
            } else if (condition === 'periodic') {
                const interval = document.querySelector('#periodic-config input[type="number"]').value;
                const timeUnit = document.querySelector('#periodic-config select').value;
                conditionDetails = `Every ${interval} ${timeUnit}`;
            } else {
                conditionDetails = 'Continuous';
            }
            
            // Create new logger
            const loggerId = Date.now(); // Unique ID
            
            const newLogger = {
                id: loggerId,
                device: {
                    id: deviceId,
                    name: device.name,
                    deviceId: device.id
                },
                tag: {
                    id: tagId,
                    name: tag.name,
                    address: tag.address,
                    description: tag.description,
                    type: tag.type,
                    unit: tag.unit
                },
                priority: priority,
                condition: condition,
                conditionDetails: conditionDetails,
                storage: {
                    size: storageSize,
                    unit: storageUnit,
                    totalMB: storageUnit === 'gb' ? storageSize * 1024 : storageSize * 1
                },
                sampling: {
                    rate: samplingRate,
                    display: samplingRate >= 60000 ? `${samplingRate/60000} min` : 
                             samplingRate >= 1000 ? `${samplingRate/1000} sec` : 
                             `${samplingRate} ms`
                },
                dataFormat: dataFormat,
                status: 'active',
                created: new Date().toISOString(),
                dataRate: (4 * (3600000 / samplingRate)) / (1024 * 1024) // MB/hour
            };
            
            dataloggers.push(newLogger);
            renderLoggersTable();
            updateSummary();
            
            modal.classList.add('hidden');
            resetModal();
            
            showNotification(`Datalogger for ${tag.name} added successfully`, 'success');
        });
    }
    
    // Reset modal form
    function resetModal() {
        document.getElementById('logger-device-select').value = '';
        document.getElementById('logger-tag-select').innerHTML = '<option value="">-- First select a device --</option>';
        document.getElementById('logger-tag-select').disabled = true;
        document.getElementById('tag-description').classList.add('hidden');
        document.querySelector('input[name="logger-priority"][value="medium"]').checked = true;
        document.querySelector('input[name="logger-condition"][value="periodic"]').checked = true;
        
        // Reset condition panels
        document.querySelectorAll('.condition-panel').forEach(panel => {
            panel.classList.add('hidden');
        });
        document.getElementById('periodic-config').classList.remove('hidden');
        document.getElementById('range-config').classList.add('hidden');
        
        // Reset form values
        document.getElementById('logger-storage-size').value = '100';
        document.getElementById('logger-storage-unit').value = 'mb';
        document.getElementById('sampling-rate').value = '5000';
        document.getElementById('data-format').value = 'compressed';
        
        // Reset condition inputs
        document.querySelector('#on-change-config input[type="text"]').value = '5';
        document.querySelector('#threshold-config input[type="text"]').value = '80';
        document.querySelector('#periodic-config input[type="number"]').value = '10';
        
        updateEstimate();
    }
    
    // Helper function for updateEstimate in resetModal
    function updateEstimate() {
        const storageSizeInput = document.getElementById('logger-storage-size');
        const storageUnitSelect = document.getElementById('logger-storage-unit');
        const samplingRateSelect = document.getElementById('sampling-rate');
        
        const size = parseFloat(storageSizeInput.value) || 100;
        const unit = storageUnitSelect.value;
        const sampling = parseInt(samplingRateSelect.value) || 5000;
        
        const storageMB = unit === 'gb' ? size * 1024 : size;
        const bytesPerSample = 4;
        const samplesPerHour = (3600000 / sampling);
        const mbPerHour = (bytesPerSample * samplesPerHour) / (1024 * 1024);
        const estimatedHours = storageMB / mbPerHour;
        
        document.getElementById('estimated-duration').textContent = 
            estimatedHours >= 8760 ? '>1 year' : 
            estimatedHours >= 720 ? `${Math.round(estimatedHours/24)} days` :
            estimatedHours >= 24 ? `${Math.round(estimatedHours/24)} days` :
            `${Math.round(estimatedHours)} hours`;
    }
    
    // Render loggers table
    function renderLoggersTable() {
        const tableBody = document.getElementById('loggers-table-body');
        const noLoggersRow = document.getElementById('no-loggers-row');
        
        if (dataloggers.length === 0) {
            noLoggersRow.classList.remove('hidden');
            return;
        }
        
        noLoggersRow.classList.add('hidden');
        tableBody.innerHTML = '';
        
        dataloggers.forEach((logger, index) => {
            const priority = priorityColors[logger.priority];
            
            const row = document.createElement('tr');
            row.className = `hover:bg-slate-50 ${priority.bg.replace('100', '50')}`;
            
            row.innerHTML = `
                <td class="px-4 py-3">
                    <div class="font-medium text-slate-900">${logger.device.name}</div>
                    <div class="text-xs text-slate-500">${logger.device.deviceId}</div>
                </td>
                <td class="px-4 py-3">
                    <div class="font-medium text-slate-900">${logger.tag.name}</div>
                    <div class="text-xs text-slate-500">${logger.tag.address}  ${logger.tag.type}</div>
                </td>
                <td class="px-4 py-3">
                    <span class="px-2 py-1 text-xs font-medium rounded-full ${priority.bg} ${priority.text}">
                        ${logger.priority.charAt(0).toUpperCase() + logger.priority.slice(1)}
                    </span>
                </td>
                <td class="px-4 py-3">
                    <div class="text-sm font-medium text-slate-900">${conditionDisplay[logger.condition] || logger.condition}</div>
                    <div class="text-xs text-slate-500">${logger.conditionDetails}</div>
                </td>
                <td class="px-4 py-3">
                    <div class="text-sm font-medium text-slate-900">${logger.storage.size} ${logger.storage.unit.toUpperCase()}</div>
                    <div class="text-xs text-slate-500">~${Math.round((logger.storage.totalMB / logger.dataRate))} hours</div>
                </td>
                <td class="px-4 py-3">
                    <div class="text-sm text-slate-900">${logger.sampling.display}</div>
                    <div class="text-xs text-slate-500">${logger.dataFormat}</div>
                </td>
                <td class="px-4 py-3">
                    <span class="px-2 py-1 text-xs font-medium ${logger.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-slate-100 text-slate-800'} rounded-full">
                        ${logger.status === 'active' ? 'Active' : 'Paused'}
                    </span>
                </td>
                <td class="px-4 py-3">
                    <div class="flex items-center gap-2">
                        <button class="edit-logger text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-50"
                                data-id="${logger.id}" title="Edit">
                            <i class="fa-solid fa-pen text-xs"></i>
                        </button>
                        <button class="delete-logger text-red-600 hover:text-red-800 p-1 rounded hover:bg-red-50"
                                data-id="${logger.id}" title="Delete">
                            <i class="fa-solid fa-trash text-xs"></i>
                        </button>
                        <button class="toggle-logger text-slate-600 hover:text-slate-800 p-1 rounded hover:bg-slate-100"
                                data-id="${logger.id}" title="${logger.status === 'active' ? 'Pause' : 'Activate'}">
                            <i class="fa-solid fa-power-off text-xs ${logger.status === 'active' ? 'text-green-600' : 'text-slate-400'}"></i>
                        </button>
                    </div>
                </td>
            `;
            
            tableBody.appendChild(row);
        });
        
        attachLoggerEventListeners();
    }
    
    // Attach event listeners to logger actions
    function attachLoggerEventListeners() {
        // Edit buttons
        document.querySelectorAll('.edit-logger').forEach(btn => {
            btn.addEventListener('click', function() {
                const loggerId = parseInt(this.dataset.id);
                const logger = dataloggers.find(l => l.id === loggerId);
                if (logger) {
                    showNotification(`Edit feature coming soon for ${logger.tag.name}`, 'info');
                }
            });
        });
        
        // Delete buttons
        document.querySelectorAll('.delete-logger').forEach(btn => {
            btn.addEventListener('click', function() {
                const loggerId = parseInt(this.dataset.id);
                const logger = dataloggers.find(l => l.id === loggerId);
                if (logger && confirm(`Delete datalogger for "${logger.tag.name}" from "${logger.device.name}"?`)) {
                    dataloggers = dataloggers.filter(l => l.id !== loggerId);
                    renderLoggersTable();
                    updateSummary();
                    showNotification(`Datalogger "${logger.tag.name}" deleted`, 'success');
                }
            });
        });
        
        // Toggle buttons
        document.querySelectorAll('.toggle-logger').forEach(btn => {
            btn.addEventListener('click', function() {
                const loggerId = parseInt(this.dataset.id);
                const logger = dataloggers.find(l => l.id === loggerId);
                if (logger) {
                    logger.status = logger.status === 'active' ? 'paused' : 'active';
                    renderLoggersTable();
                    updateSummary();
                    showNotification(`Datalogger "${logger.tag.name}" ${logger.status === 'active' ? 'activated' : 'paused'}`, 'info');
                }
            });
        });
    }
    
    // Update summary statistics
    function updateSummary() {
        const activeLoggers = dataloggers.filter(l => l.status === 'active');
        const totalStorageMB = activeLoggers.reduce((sum, logger) => sum + logger.storage.totalMB, 0);
        const totalDataRate = activeLoggers.reduce((sum, logger) => sum + logger.dataRate, 0);
        
        // Update counters
        document.getElementById('active-loggers-count').textContent = activeLoggers.length;
        document.getElementById('total-storage').textContent = 
            totalStorageMB >= 1024 ? `${(totalStorageMB/1024).toFixed(1)} GB` : `${totalStorageMB} MB`;
        document.getElementById('total-data-rate').textContent = `${totalDataRate.toFixed(2)} MB/h`;
        
        // Calculate buffer health
        let bufferHealth = 'Good';
        let healthColor = 'text-green-700';
        
        if (totalDataRate > 10) {
            bufferHealth = 'High Load';
            healthColor = 'text-amber-700';
        } else if (totalStorageMB > 4096) {
            bufferHealth = 'Large Storage';
            healthColor = 'text-blue-700';
        } else if (activeLoggers.length === 0) {
            bufferHealth = 'No Loggers';
            healthColor = 'text-slate-700';
        } else if (totalDataRate > 20) {
            bufferHealth = 'Very High';
            healthColor = 'text-red-700';
        }
        
        document.getElementById('buffer-health').textContent = bufferHealth;
        document.getElementById('buffer-health').className = `text-xl font-bold ${healthColor}`;
    }
    
    // Initialize
    initializeModal();
    renderLoggersTable();
    updateSummary();
}

// Add this to your DOMContentLoaded event listener
initializeDatalogger();
        // Fetch and insert sidebar from sidebar.html
        async function loadSidebar() {
            try {
                const response = await fetch('sidebar.html');
                if (!response.ok) {
                    throw new Error(`Failed to load sidebar: ${response.status}`);
                }
                
                const html = await response.text();
                
                // Insert the entire HTML content
                document.getElementById('sidebar-container').innerHTML = html;
                
                // Update the active page to CraneIQ Pro Configuration
                updateActivePage();
                
                // Initialize sidebar functionality
                initializeSidebar();
                
            } catch (error) {
                console.error('Error loading sidebar:', error);
                // Fallback: create a basic sidebar if fetch fails
                createFallbackSidebar();
            }
        }

        // Create fallback sidebar if fetch fails
        function createFallbackSidebar() {
            const fallbackHTML = `
                <div class="sidebar" id="sidebar">
                    <div class="sidebar-logo">
                        <div class="logo-text">
                            <i class="fa-solid fa-layer-group mr-2"></i> Innospace
                        </div>
                    </div>
                    <div class="sidebar-nav">
                        <div class="nav-section">
                            <div class="section-title">Configuration</div>
                            <a href="general-configuration.html" class="nav-item">
                                <i class="fa-solid fa-sliders"></i> General Configuration
                            </a>
                            <a href="device-management.html" class="nav-item">
                                <i class="fa-solid fa-microchip"></i> Device Management
                            </a>
                            <a href="craneiq-config.html" class="nav-item active">
                                <i class="fa-solid fa-crane"></i> CraneIQ Pro
                            </a>
                            <a href="protocol-integration.html" class="nav-item">
                                <i class="fa-solid fa-plug"></i> Protocol Integration
                            </a>
                            <a href="ota-recovery.html" class="nav-item">
                                <i class="fa-solid fa-cloud-arrow-up"></i> OTA & Recovery
                            </a>
                            <a href="monitoring-analytics.html" class="nav-item">
                                <i class="fa-solid fa-chart-line"></i> Monitoring & Analytics
                            </a>
                        </div>
                        <div class="nav-section">
                            <div class="section-title">System</div>
                            <a href="backup-restore.html" class="nav-item">
                                <i class="fa-solid fa-database"></i> Backup & Restore
                            </a>
                            <a href="logs-diagnostics.html" class="nav-item">
                                <i class="fa-solid fa-file-lines"></i> Logs & Diagnostics
                            </a>
                            <a href="user-management.html" class="nav-item">
                                <i class="fa-solid fa-users"></i> User Management
                            </a>
                            <a href="help-support.html" class="nav-item">
                                <i class="fa-solid fa-circle-question"></i> Help & Support
                            </a>
                        </div>
                    </div>
                    <div class="sidebar-footer">
                        <div class="user-profile">
                            <div class="user-avatar">
                                <i class="fa-solid fa-user"></i>
                            </div>
                            <div class="user-info">
                                <h4 class="text-sm font-semibold text-slate-800">Admin User</h4>
                                <p class="text-xs text-slate-500">System Administrator</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sidebar-toggle" id="sidebarToggle">
                    <i class="fa-solid fa-bars"></i>
                </div>
            `;
            
            document.getElementById('sidebar-container').innerHTML = fallbackHTML;
            initializeSidebar();
        }

        // Update active page in sidebar
        function updateActivePage() {
            // Remove active class from all nav items
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.classList.remove('active');
            });
            
            // Add active class to CraneIQ Pro
            const craneLink = Array.from(navItems).find(item => 
                item.textContent.includes('CraneIQ Pro') || 
                item.textContent.includes('CraneIQ') ||
                item.textContent.includes('Crane')
            );
            
            if (craneLink) {
                craneLink.classList.add('active');
            }
        }

        // Initialize sidebar functionality
        function initializeSidebar() {
            const sidebar = document.getElementById('sidebar');
            const sidebarToggle = document.getElementById('sidebarToggle');
            
            if (!sidebar || !sidebarToggle) return;
            
            // Toggle sidebar
            sidebarToggle.addEventListener('click', function() {
                sidebar.classList.toggle('active');
                
                // Toggle icon
                const icon = this.querySelector('i');
                if (sidebar.classList.contains('active')) {
                    icon.className = 'fa-solid fa-times';
                } else {
                    icon.className = 'fa-solid fa-bars';
                }
            });
            
            // Handle mobile menu
            if (window.innerWidth <= 1024) {
                sidebar.classList.add('active');
                sidebarToggle.style.left = '260px';
                sidebarToggle.querySelector('i').className = 'fa-solid fa-times';
            }
            
            // Update on resize
            window.addEventListener('resize', handleResponsive);
        }

        // Handle responsive behavior
        function handleResponsive() {
            const sidebar = document.getElementById('sidebar');
            const sidebarToggle = document.getElementById('sidebarToggle');
            
            if (window.innerWidth <= 1024) {
                sidebar.classList.remove('active');
                sidebarToggle.style.display = 'block';
                sidebarToggle.style.left = '0';
                sidebarToggle.querySelector('i').className = 'fa-solid fa-bars';
            } else {
                sidebar.classList.remove('collapsed');
                sidebar.classList.remove('active');
                sidebarToggle.style.display = 'none';
                sidebarToggle.style.left = '260px';
            }
        }

        // Close sidebar when clicking outside on mobile
        function handleSidebarClickOutside(event) {
            const sidebar = document.getElementById('sidebar');
            const sidebarToggle = document.getElementById('sidebarToggle');
            const isMobile = window.innerWidth <= 1024;
            
            if (isMobile && sidebar.classList.contains('active')) {
                const isClickInsideSidebar = sidebar.contains(event.target);
                const isClickOnToggle = sidebarToggle.contains(event.target);
                
                if (!isClickInsideSidebar && !isClickOnToggle) {
                    sidebar.classList.remove('active');
                    sidebarToggle.querySelector('i').className = 'fa-solid fa-bars';
                    sidebarToggle.style.left = '0';
                }
            }
        }

        // Show notification
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notification-container');
            
            const notification = document.createElement('div');
            notification.className = `px-4 py-3 rounded-md shadow-lg border transform transition-all duration-300 translate-x-64 opacity-0`;
            
            const colors = {
                info: 'bg-blue-50 text-blue-800 border-blue-200',
                success: 'bg-green-50 text-green-800 border-green-200',
                warning: 'bg-amber-50 text-amber-800 border-amber-200',
                error: 'bg-red-50 text-red-800 border-red-200'
            };
            
            notification.className += ` ${colors[type]}`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fa-solid ${type === 'info' ? 'fa-circle-info' : type === 'success' ? 'fa-circle-check' : type === 'warning' ? 'fa-triangle-exclamation' : 'fa-circle-xmark'} mr-2"></i>
                    <span>${message}</span>
                </div>
            `;
            
            container.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.classList.remove('translate-x-64', 'opacity-0');
                notification.classList.add('translate-x-0', 'opacity-100');
            }, 10);
            
            // Remove after 5 seconds
            setTimeout(() => {
                notification.classList.remove('translate-x-0', 'opacity-100');
                notification.classList.add('translate-x-64', 'opacity-0');
                
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 5000);
        }

        // Initialize button event listeners
        function initializeButtons() {
            // Header buttons
            document.getElementById('reset-btn')?.addEventListener('click', function() {
                if (confirm('Reset all settings to defaults?')) {
                    showNotification('Settings reset to defaults', 'info');
                }
            });
            
            document.getElementById('cancel-btn')?.addEventListener('click', function() {
                if (confirm('Cancel all changes?')) {
                    window.location.reload();
                }
            });
            
            document.getElementById('save-btn')?.addEventListener('click', function() {
                saveConfiguration();
            });
            
            // Footer buttons
            document.getElementById('test-btn')?.addEventListener('click', function() {
                showNotification('Testing connection to crane...', 'info');
                setTimeout(() => {
                    showNotification('Connection test successful!', 'success');
                }, 2000);
            });
            
            document.getElementById('footer-reset-btn')?.addEventListener('click', function() {
                if (confirm('Reset all CraneIQ settings to factory defaults?')) {
                    showNotification('CraneIQ settings reset to defaults', 'info');
                }
            });
            
            document.getElementById('footer-cancel-btn')?.addEventListener('click', function() {
                if (confirm('Cancel all changes?')) {
                    window.location.reload();
                }
            });
            
            document.getElementById('footer-save-btn')?.addEventListener('click', function() {
                saveConfiguration();
            });
            
            // New buttons
            document.getElementById('upload-layout-btn')?.addEventListener('click', function() {
                showNotification('Upload layout dialog opened', 'info');
            });
            
            document.getElementById('add-peer-btn')?.addEventListener('click', function() {
                showNotification('Add peer crane dialog opened', 'info');
            });
            
            document.getElementById('add-zone-btn')?.addEventListener('click', function() {
                showNotification('Add new zone dialog opened', 'info');
            });
            
            // File upload
            document.getElementById('load-curve-upload')?.addEventListener('click', function() {
                document.getElementById('load-curve-file').click();
            });
            
            document.getElementById('load-curve-file')?.addEventListener('change', function(e) {
                if (e.target.files.length > 0) {
                    const fileName = e.target.files[0].name;
                    showNotification(`Load curve file uploaded: ${fileName}`, 'success');
                }
            });
        }

        // Save configuration function
        function saveConfiguration() {
            const saveBtn = document.getElementById('save-btn');
            const footerSaveBtn = document.getElementById('footer-save-btn');
            
            if (saveBtn) {
                saveBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin mr-2"></i> Saving...';
                saveBtn.disabled = true;
            }
            if (footerSaveBtn) {
                footerSaveBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin mr-2"></i> Saving...';
                footerSaveBtn.disabled = true;
            }
            
            // Simulate API call
            setTimeout(() => {
                if (saveBtn) {
                    saveBtn.innerHTML = '<i class="fa-solid fa-floppy-disk mr-2"></i> Save Changes';
                    saveBtn.disabled = false;
                }
                if (footerSaveBtn) {
                    footerSaveBtn.innerHTML = '<i class="fa-solid fa-floppy-disk mr-2"></i> Save Configuration';
                    footerSaveBtn.disabled = false;
                }
                
                showNotification('CraneIQ configuration saved successfully!', 'success');
            }, 1500);
        }

        // Initialize toggle switches
        function initializeToggles() {
            document.querySelectorAll('input[type="checkbox"][class*="peer"]').forEach(toggle => {
                toggle.addEventListener('change', function() {
                    const settingName = this.closest('div')?.querySelector('span')?.textContent || 'Setting';
                    const status = this.checked ? 'enabled' : 'disabled';
                    showNotification(`${settingName} ${status}`, 'info');
                });
            });
        }

        // Initialize select dropdowns
        function initializeSelects() {
            document.querySelectorAll('select').forEach(select => {
                select.addEventListener('change', function() {
                    const settingName = this.previousElementSibling?.textContent || 'Setting';
                    const value = this.options[this.selectedIndex].text;
                    showNotification(`${settingName} changed to: ${value}`, 'info');
                });
            });
        }

        // Initialize operating mode buttons
        function initializeModeButtons() {
            const modeButtons = document.querySelectorAll('.flex.bg-slate-100 button');
            modeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    modeButtons.forEach(btn => {
                        btn.classList.remove('bg-blue-600', 'text-white', 'shadow');
                        btn.classList.add('text-slate-600', 'hover:bg-slate-50');
                    });
                    this.classList.add('bg-blue-600', 'text-white', 'shadow');
                    this.classList.remove('text-slate-600', 'hover:bg-slate-50');
                    
                    const mode = this.textContent;
                    showNotification(`Operating mode set to: ${mode}`, 'info');
                });
            });
        }

        // Initialize rule engine navigation
        function initializeRuleEngine() {
            // Add smooth scroll for rule links
            document.querySelectorAll('a[href^="#"]').forEach(link => {
                link.addEventListener('click', function(e) {
                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;
                    
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        e.preventDefault();
                        
                        // Highlight the target section with animation
                        targetElement.classList.add('highlight-section');
                        
                        // Scroll to the section
                        targetElement.scrollIntoView({ 
                            behavior: 'smooth',
                            block: 'start'
                        });
                        
                        // Remove highlight after animation completes
                        setTimeout(() => {
                            targetElement.classList.remove('highlight-section');
                        }, 2000);
                        
                        // Show notification
                        const sectionName = targetElement.querySelector('h2, h3')?.textContent || 'Configuration Section';
                        showNotification(`Navigated to ${sectionName}`, 'info');
                    }
                });
            });
        }

        // DOM Content Loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('CraneIQ Pro Configuration Initialized');
            
            // Load sidebar first
            loadSidebar();
            
            // Initialize components
            initializeButtons();
            initializeToggles();
            initializeSelects();
            initializeModeButtons();
            initializeRuleEngine();
            
            // Add click outside handler for sidebar
            document.addEventListener('click', handleSidebarClickOutside);
            
            // Initial responsive setup
            setTimeout(() => {
                handleResponsive();
            }, 100);
        });
    </script>
</body>
</html>